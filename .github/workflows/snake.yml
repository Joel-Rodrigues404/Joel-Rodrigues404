name: Generate Snake Animation

on:
  schedule: # Daily generation at midnight UTC
    - cron: "0 0 * * *"
  workflow_dispatch: # Manual execution option

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Generate Snake
        uses: platane/snk@v3
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # Required for authentication
          github_user_name: Joel-Rodrigues404  # Replace with your username

      - name: Deploy Snake Animation
        uses: crazy-max/ghaction-github-pages@v2
        with:
          node-version: '20'  # Specify Node.js version (explicitly recommended)
          build_dir: ./dist  # Directory containing the generated animation (dist/github-snake-dark.svg)
          target_branch: output  # Branch for deployment

      - name: Configure Git (optional, but recommended for cleaner deployments)
        uses: actions/checkout@v3  # Fetch the latest code (optional)
        with:
          fetch-depth: 0  # Retrieve all branches and commit history (optional)
      - name: Add generated animation (optional, but recommended for version control)
        run: |
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          git add -f ./output/github-snake-dark.svg  # Add the animation file
          git commit -m "Add generated Snake animation"  # Commit the change (optional)
        env:
          GIT_TOKEN: ${{ secrets.GH_PAT }}  # Required for Git operations